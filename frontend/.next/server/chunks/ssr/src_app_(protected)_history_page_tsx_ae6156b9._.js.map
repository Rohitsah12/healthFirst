{"version":3,"sources":["turbopack:///[project]/src/app/(protected)/history/page.tsx","turbopack:///[project]/src/app/components/shared/StatusBadge.tsx","turbopack:///[project]/node_modules/lucide-react/src/icons/download.ts","turbopack:///[project]/src/app/components/history/HistoryTable.tsx"],"sourcesContent":["'use client';\r\nimport { useState, useEffect } from 'react';\r\nimport { useAppDispatch, useAppSelector } from '../../store/store';\r\nimport { fetchVisitHistory } from '../../store/visitHistorySlice';\r\nimport { exportVisitHistory, VisitHistoryQuery } from '../../services/visitApi';\r\nimport { Download } from 'lucide-react';\r\nimport { HistoryTable } from '../../components/history/HistoryTable'; // Assuming this component exists\r\n\r\n// Helper to get today's date in YYYY-MM-DD format\r\nconst getTodayString = () => new Date().toISOString().split('T')[0];\r\n\r\nexport default function VisitHistoryPage() {\r\n  const dispatch = useAppDispatch();\r\n  const { visits, summary, status } = useAppSelector((state) => state.visitHistory);\r\n\r\n  const [selectedDate, setSelectedDate] = useState<string>(getTodayString());\r\n\r\n  useEffect(() => {\r\n    // Fetch history whenever the selectedDate changes\r\n    if (selectedDate) {\r\n      dispatch(fetchVisitHistory({ date: selectedDate }));\r\n    }\r\n  }, [selectedDate, dispatch]);\r\n\r\n  const handleExport = async () => {\r\n    try {\r\n      const blob = await exportVisitHistory({ date: selectedDate });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `visit-history-${selectedDate}.xlsx`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      a.remove();\r\n    } catch (error) {\r\n      console.error(\"Failed to export Excel file:\", error);\r\n      // You can show a notification to the user here\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold text-gray-800\">Visit History</h1>\r\n        <p className=\"text-gray-600 mt-1\">Detailed audit log of all patient visits</p>\r\n      </div>\r\n\r\n      <div className=\"bg-white rounded-xl shadow-lg\">\r\n        {/* Simplified Filter Section */}\r\n        <div className=\"p-6 border-b border-gray-200 flex justify-between items-center\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <label htmlFor=\"visit-date\" className=\"font-bold text-gray-700\">Select Date:</label>\r\n            <input\r\n              id=\"visit-date\"\r\n              type=\"date\"\r\n              value={selectedDate}\r\n              onChange={(e) => setSelectedDate(e.target.value)}\r\n              className=\"border-2 border-gray-300 rounded-lg px-4 py-2 font-medium text-gray-700\"\r\n            />\r\n          </div>\r\n          <button \r\n            onClick={handleExport}\r\n            className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 font-medium\"\r\n          >\r\n            <Download size={16} /> Export Excel\r\n          </button>\r\n        </div>\r\n        \r\n        {/* You can add the summary section here if you wish */}\r\n        \r\n        <div className=\"p-6\">\r\n          <HistoryTable visits={visits} isLoading={status === 'loading'} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","import React from \"react\";\r\n\r\nenum VisitStatus {\r\n  COMPLETED = \"COMPLETED\",\r\n  CANCELLED = \"CANCELLED\",\r\n  WITH_DOCTOR = \"WITH_DOCTOR\",\r\n  CHECKED_IN = \"CHECKED_IN\",\r\n  SCHEDULED = \"SCHEDULED\",\r\n}\r\n\r\ninterface StatusBadgeProps {\r\n  status: string | VisitStatus | null | undefined;\r\n}\r\n\r\nconst tailwindClasses: Record<string, string> = {\r\n  COMPLETED: \"px-3 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700\",\r\n  CANCELLED: \"px-3 py-1 rounded-full text-xs font-bold bg-red-100 text-red-700\",\r\n  WITH_DOCTOR: \"px-3 py-1 rounded-full text-xs font-bold bg-amber-100 text-amber-800\",\r\n  CHECKED_IN: \"px-3 py-1 rounded-full text-xs font-bold bg-blue-100 text-blue-700\",\r\n  SCHEDULED: \"px-3 py-1 rounded-full text-xs font-bold bg-gray-100 text-gray-700\",\r\n};\r\n\r\nconst colorHex: Record<string, { bg: string; fg: string }> = {\r\n  COMPLETED: { bg: \"#dcfce7\", fg: \"#15803d\" },\r\n  CANCELLED: { bg: \"#fee2e2\", fg: \"#b91c1c\" },\r\n  WITH_DOCTOR: { bg: \"#fffbeb\", fg: \"#854d0e\" },\r\n  CHECKED_IN: { bg: \"#ebf8ff\", fg: \"#075985\" },\r\n  SCHEDULED: { bg: \"#f3f4f6\", fg: \"#374151\" },\r\n};\r\n\r\nexport const StatusBadge = ({ status }: StatusBadgeProps) => {\r\n  const key = (status ?? \"\").toString().trim().toUpperCase();\r\n  const classes = tailwindClasses[key] ?? \"px-3 py-1 rounded-full text-xs font-bold bg-gray-100 text-gray-700\";\r\n  const colors = colorHex[key];\r\n\r\n  return (\r\n    <span\r\n      className={classes}\r\n      style={colors ? { backgroundColor: colors.bg, color: colors.fg } : undefined}\r\n    >\r\n      {key || \"UNKNOWN\"}\r\n    </span>\r\n  );\r\n};\r\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M12 15V3', key: 'm9g1x1' }],\n  ['path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4', key: 'ih7n3h' }],\n  ['path', { d: 'm7 10 5 5 5-5', key: 'brsn70' }],\n];\n\n/**\n * @component @name Download\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgMTVWMyIgLz4KICA8cGF0aCBkPSJNMjEgMTV2NGEyIDIgMCAwIDEtMiAySDVhMiAyIDAgMCAxLTItMnYtNCIgLz4KICA8cGF0aCBkPSJtNyAxMCA1IDUgNS01IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/download\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Download = createLucideIcon('download', __iconNode);\n\nexport default Download;\n","import React from 'react';\r\nimport { Visit } from '../../store/types';\r\n\r\nimport { StatusBadge } from '../shared/StatusBadge';\r\n\r\ninterface HistoryTableProps {\r\n  visits: Visit[];\r\n  isLoading: boolean;\r\n}\r\n\r\nexport const HistoryTable = ({ visits, isLoading }: HistoryTableProps) => {\r\n  if (isLoading) {\r\n    return <div className=\"p-12 text-center text-gray-600\">Loading history...</div>;\r\n  }\r\n  if (visits.length === 0) {\r\n    return <div className=\"p-12 text-center text-gray-500\">No visits found for the selected filters.</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"overflow-x-auto\">\r\n      <table className=\"w-full\">\r\n        <thead>\r\n          <tr className=\"border-b-2 border-gray-200\">\r\n            <th className=\"p-4 font-bold text-left text-gray-700\">Date</th>\r\n            <th className=\"p-4 font-bold text-left text-gray-700\">Type</th>\r\n            <th className=\"p-4 font-bold text-left text-gray-700\">Patient</th>\r\n            <th className=\"p-4 font-bold text-left text-gray-700\">Doctor</th>\r\n            <th className=\"p-4 font-bold text-left text-gray-700\">Status</th>\r\n            <th className=\"p-4 font-bold text-left text-gray-700\">Time</th>\r\n            <th className=\"p-4 font-bold text-left text-gray-700\">Priority</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {visits.map((visit) => (\r\n            <React.Fragment key={visit.id}>\r\n              {visit.logs.map((log, index) => (\r\n                <tr key={`${visit.id}-${index}`} className=\"border-b border-gray-100 hover:bg-gray-50\">\r\n                  {index === 0 && (\r\n                    <>\r\n                      <td rowSpan={visit.logs.length} className=\"p-4 align-top font-medium text-gray-800\">\r\n                        {new Date(visit.createdAt).toLocaleDateString()}\r\n                      </td>\r\n                      <td rowSpan={visit.logs.length} className=\"p-4 align-top\">\r\n                        <span className={`px-3 py-1 rounded-full text-xs font-medium ${\r\n                          visit.visitType === 'WALK_IN' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\r\n                        }`}>\r\n                          {visit.visitType}\r\n                        </span>\r\n                      </td>\r\n                      <td rowSpan={visit.logs.length} className=\"p-4 align-top text-gray-700\">\r\n                        {visit.patient.name}\r\n                      </td>\r\n                      <td rowSpan={visit.logs.length} className=\"p-4 align-top text-gray-700\">\r\n                        {visit.doctor.user.name}\r\n                      </td>\r\n                    </>\r\n                  )}\r\n                  <td className=\"p-4\">\r\n                    <StatusBadge status={log.status} />\r\n                  </td>\r\n                  <td className=\"p-4 text-gray-600 text-sm\">\r\n                    {new Date(log.timestamp).toLocaleString()}\r\n                  </td>\r\n                  {index === 0 && (\r\n                    <td rowSpan={visit.logs.length} className=\"p-4 align-top\">\r\n                      <span className={`px-3 py-1 rounded-full text-xs font-medium ${\r\n                        visit.priority === 'URGENT' ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-700'\r\n                      }`}>\r\n                        {visit.priority}\r\n                      </span>\r\n                    </td>\r\n                  )}\r\n                </tr>\r\n              ))}\r\n            </React.Fragment>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":"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","ignoreList":[2]}