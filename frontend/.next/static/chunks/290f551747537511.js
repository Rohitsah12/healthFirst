(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51312,e=>{"use strict";e.s(["default",()=>g],51312);var t=e.i(43476),l=e.i(71645),s=e.i(80785),a=e.i(67175),r=e.i(2954);let d=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var n=function(e){return e.COMPLETED="COMPLETED",e.CANCELLED="CANCELLED",e.WITH_DOCTOR="WITH_DOCTOR",e.CHECKED_IN="CHECKED_IN",e.SCHEDULED="SCHEDULED",e}(n||{});let o={COMPLETED:"px-3 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700",CANCELLED:"px-3 py-1 rounded-full text-xs font-bold bg-red-100 text-red-700",WITH_DOCTOR:"px-3 py-1 rounded-full text-xs font-bold bg-amber-100 text-amber-800",CHECKED_IN:"px-3 py-1 rounded-full text-xs font-bold bg-blue-100 text-blue-700",SCHEDULED:"px-3 py-1 rounded-full text-xs font-bold bg-gray-100 text-gray-700"},i={COMPLETED:{bg:"#dcfce7",fg:"#15803d"},CANCELLED:{bg:"#fee2e2",fg:"#b91c1c"},WITH_DOCTOR:{bg:"#fffbeb",fg:"#854d0e"},CHECKED_IN:{bg:"#ebf8ff",fg:"#075985"},SCHEDULED:{bg:"#f3f4f6",fg:"#374151"}},c=e=>{var l;let{status:s}=e,a=(null!=s?s:"").toString().trim().toUpperCase(),r=null!=(l=o[a])?l:"px-3 py-1 rounded-full text-xs font-bold bg-gray-100 text-gray-700",d=i[a];return(0,t.jsx)("span",{className:r,style:d?{backgroundColor:d.bg,color:d.fg}:void 0,children:a||"UNKNOWN"})},x=e=>{let{visits:s,isLoading:a}=e;return a?(0,t.jsx)("div",{className:"p-12 text-center text-gray-600",children:"Loading history..."}):0===s.length?(0,t.jsx)("div",{className:"p-12 text-center text-gray-500",children:"No visits found for the selected filters."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b-2 border-gray-200",children:[(0,t.jsx)("th",{className:"p-4 font-bold text-left text-gray-700",children:"Date"}),(0,t.jsx)("th",{className:"p-4 font-bold text-left text-gray-700",children:"Type"}),(0,t.jsx)("th",{className:"p-4 font-bold text-left text-gray-700",children:"Patient"}),(0,t.jsx)("th",{className:"p-4 font-bold text-left text-gray-700",children:"Doctor"}),(0,t.jsx)("th",{className:"p-4 font-bold text-left text-gray-700",children:"Status"}),(0,t.jsx)("th",{className:"p-4 font-bold text-left text-gray-700",children:"Time"}),(0,t.jsx)("th",{className:"p-4 font-bold text-left text-gray-700",children:"Priority"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>(0,t.jsx)(l.default.Fragment,{children:e.logs.map((l,s)=>(0,t.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[0===s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{rowSpan:e.logs.length,className:"p-4 align-top font-medium text-gray-800",children:new Date(e.createdAt).toLocaleDateString()}),(0,t.jsx)("td",{rowSpan:e.logs.length,className:"p-4 align-top",children:(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("WALK_IN"===e.visitType?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"),children:e.visitType})}),(0,t.jsx)("td",{rowSpan:e.logs.length,className:"p-4 align-top text-gray-700",children:e.patient.name}),(0,t.jsx)("td",{rowSpan:e.logs.length,className:"p-4 align-top text-gray-700",children:e.doctor.user.name})]}),(0,t.jsx)("td",{className:"p-4",children:(0,t.jsx)(c,{status:l.status})}),(0,t.jsx)("td",{className:"p-4 text-gray-600 text-sm",children:new Date(l.timestamp).toLocaleString()}),0===s&&(0,t.jsx)("td",{rowSpan:e.logs.length,className:"p-4 align-top",children:(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("URGENT"===e.priority?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:e.priority})})]},"".concat(e.id,"-").concat(s)))},e.id))})]})})};function g(){let e=(0,s.useAppDispatch)(),{visits:n,summary:o,status:i}=(0,s.useAppSelector)(e=>e.visitHistory),[c,g]=(0,l.useState)(new Date().toISOString().split("T")[0]);(0,l.useEffect)(()=>{c&&e((0,a.fetchVisitHistory)({date:c}))},[c,e]);let p=async()=>{try{let e=await (0,r.exportVisitHistory)({date:c}),t=window.URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download="visit-history-".concat(c,".xlsx"),document.body.appendChild(l),l.click(),l.remove()}catch(e){console.error("Failed to export Excel file:",e)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Visit History"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Detailed audit log of all patient visits"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("label",{htmlFor:"visit-date",className:"font-bold text-gray-700",children:"Select Date:"}),(0,t.jsx)("input",{id:"visit-date",type:"date",value:c,onChange:e=>g(e.target.value),className:"border-2 border-gray-300 rounded-lg px-4 py-2 font-medium text-gray-700"})]}),(0,t.jsxs)("button",{onClick:p,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 font-medium",children:[(0,t.jsx)(d,{size:16})," Export Excel"]})]}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(x,{visits:n,isLoading:"loading"===i})})]})]})}}]);